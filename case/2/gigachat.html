<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Платформер</title>
<style>
body {
    font-family: Arial, Helvetica, sans-serif;
    background-color: #ffffff;
    overflow: hidden;
    user-select: none;
}

#game-canvas {
    border: 1px solid black;
    display: block;
    margin: auto;
    max-width: 100vw;
    max-height: 100vh;
}

.question {
    text-align: center;
    font-weight: bold;
    margin-top: 1rem;
}
</style>
</head>
<body>
<h1 class="question">В каком году закончилась Великая Отечественная война?</h1>
<canvas id="game-canvas" width="600" height="400"></canvas>

<script>
const canvas = document.getElementById("game-canvas");
const ctx = canvas.getContext("2d");
let platforms = [];
let player = {};
let gameOver = false;

// Настройки игры
const gravity = 0.5;
const jumpForce = 15;
const platformColors = ["gray", "#FFDDCC"];
const correctAnswerYear = 1945;

class Platform {
    constructor(x, y, w, h, year) {
        this.x = x;
        this.y = y;
        this.w = w;
        this.h = h;
        this.year = year;
        this.color = platformColors[year === correctAnswerYear ? 1 : 0];
    }

    draw() {
        ctx.fillStyle = this.color;
        ctx.fillRect(this.x, this.y, this.w, this.h);
        ctx.font = 'bold 16px Arial';
        ctx.textAlign = 'center';
        ctx.fillText(this.year, this.x + this.w / 2, this.y + this.h / 2 + 5);
    }
}

player = new class Player {
    constructor(x, y, size) {
        this.x = x;
        this.y = y;
        this.size = size;
        this.vy = 0;
        this.isJumping = true;
    }

    update() {
        this.vy += gravity;
        this.y += this.vy;

        // Проверяем столкновение с платформами
        platforms.forEach((platform) => {
            if (
                this.x + this.size > platform.x &&
                this.x < platform.x + platform.w &&
                this.y + this.size >= platform.y &&
                this.y <= platform.y + platform.h
            ) {
                if (!this.isJumping && this.vy > 0) {
                    this.y = platform.y - this.size;
                    this.vy = 0;
                    this.isJumping = false;
                    
                    if (platform.year !== correctAnswerYear) {
                        resetGame(); // Игра заканчивается, если игрок выбрал неверную дату
                    }
                }
            }
        });

        // Ограничиваем движение игрока сверху и снизу холста
        if (this.y + this.size > canvas.height || this.y < 0) {
            resetGame();
        }
    }

    draw() {
        ctx.fillStyle = '#0000ff'; // синий студент
        ctx.fillRect(this.x, this.y, this.size, this.size);
    }

    jump() {
        if (!this.isJumping) {
            this.vy -= jumpForce;
            this.isJumping = true;
        }
    }
};

function createPlatforms() {
    platforms.push(new Platform(canvas.width / 2 - 100, canvas.height - 100, 100, 20, 1941)); // Первая дата
    platforms.push(new Platform(canvas.width / 2, canvas.height - 100, 100, 20, 1945));       // Правильная дата
    platforms.push(new Platform(canvas.width / 2 + 100, canvas.height - 100, 100, 20, 1949)); // Последняя дата
}

function startGame() {
    player = new Player(canvas.width / 2 - 10, canvas.height - 30, 20);
    createPlatforms();
    requestAnimationFrame(update);
}

function update() {
    if (gameOver) return;

    ctx.clearRect(0, 0, canvas.width, canvas.height);
    platforms.forEach(p => p.draw());
    player.update();
    player.draw();

    requestAnimationFrame(update);
}

function resetGame() {
    gameOver = true;
    alert("Игра закончена!");
    location.reload();
}

startGame();

window.addEventListener("keydown", event => {
    if (event.code === "Space") {
        player.jump();
    }
});
</script>
</body>
</html>


